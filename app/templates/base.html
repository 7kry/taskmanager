<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>{{ title }} - TaskManager</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <style>
      body {
        padding-top: 70px; /* Adjust this value if needed */
      }
      .navbar-search {
        position: relative;
      }
      .navbar-search input {
        padding-left: 30px;
      }
      .navbar-search .fa-search {
        position: absolute;
        left: 10px;
        top: 50%;
        transform: translateY(-50%);
        color: #aaa;
      }
      .ui-autocomplete {
        z-index: 1050; /* Ensure the autocomplete suggestions appear above the navbar */
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
      <a class="navbar-brand" href="#">TaskManager</a>
      <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('index') }}">{{ get_translation('Home') }}</a>
          </li>
          {% if current_user.is_authenticated %}
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('mypage') }}">{{ get_translation('My Page') }}</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('tasks') }}">{{ get_translation('Create Task') }}</a>
          </li>
          {% endif %}
        </ul>
        {% if current_user.is_authenticated %}
        <form class="form-inline my-2 my-lg-0 mr-3 navbar-search">
          <i class="fas fa-search"></i>
          <input class="form-control mr-sm-2" type="search" placeholder="{{ get_translation('Search users') }}" aria-label="Search" id="userSearch">
        </form>
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('user', username=current_user.username) }}">
              <i class="fas fa-user"></i> {{ current_user.username }}
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('preferences') }}">
              <i class="fas fa-cog"></i>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('logout') }}">{{ get_translation('Logout') }}</a>
          </li>
        </ul>
        {% else %}
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('login') }}">{{ get_translation('Sign In') }}</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('register') }}">{{ get_translation('Register') }}</a>
          </li>
        </ul>
        {% endif %}
      </div>
    </nav>
    <main role="main" class="container mt-5">
      <div class="starter-template">
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
          {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}
      </div>
    </main>
    {% block scripts %}
    <script>
      $(function() {
        $("#userSearch").autocomplete({
          source: function(request, response) {
            $.ajax({
              url: "{{ url_for('autocomplete') }}",
              data: {
                q: request.term
              },
              success: function(data) {
                response(data);
              }
            });
          },
          minLength: 2,
          select: function(event, ui) {
            window.location.href = "/@" + ui.item.value;
          }
        });
      });
    </script>
    {% endblock %}
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
<!-- vim:ts=2:sts=2:sw=2:et -->
